import{a as X}from"./formatters-1588bd0d.js";import{_ as oe}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-01c6a1ae.js";import{d as Q,J as le,r as A,bm as D,w as ee,o as c,h as S,f as m,b as n,W as me,e as a,R as h,k as e,c as f,F as pe,cQ as P,ci as F,Z as fe,Q as T,cR as J,H as ve,cS as _e,M as I,a0 as G,y as O,V as te,bq as ge,db as he}from"./index-ab2bc521.js";import{_ as ne}from"./AppTextField.vue_vue_type_style_index_0_lang-ff2427f7.js";import{_ as z}from"./LoadingIcon.vue_vue_type_script_setup_true_lang-2352b216.js";import{_ as xe}from"./FileUploader.vue_vue_type_style_index_0_lang-3a2ac34b.js";import{_ as we}from"./CustomDropdown.vue_vue_type_script_setup_true_lang-504303ee.js";import{V as re}from"./VCard-c9d7cfad.js";import{V as ye}from"./VForm-bdbb87d6.js";import{V as be}from"./VSwitch-75acd94a.js";import{V as ce}from"./VDialog-4ab52581.js";import{_ as Ve}from"./DeletePopup.vue_vue_type_script_setup_true_lang-8649cda4.js";import{_ as ke}from"./Pagination.vue_vue_type_script_setup_true_lang-6d9bdbde.js";import{_ as se}from"./Lucide.vue_vue_type_script_setup_true_lang-5dcb49e0.js";import{V as ae}from"./VAvatar-b89a8ade.js";import{V as ie}from"./VImg-7ee89f5e.js";import{V as $e}from"./VSelect-9cc3df93.js";import{V as Ue}from"./VDataTableServer-3c5957d4.js";import"./VTextField-bc742ce7.js";import"./transition-99e7ac04.js";import"./forwardRefs-6ea3df5c.js";import"./VTooltip-1a5a6ea6.js";import"./VOverlay-39b4b039.js";import"./VMenu-6ec9b18a.js";import"./dialog-transition-6ea18c7a.js";import"./createSimpleFunctional-c52b7322.js";import"./VCardText-6d82c75f.js";import"./VSelectionControl-e6ec7db0.js";import"./VList-6df8630b.js";import"./VListItem-93d403d9.js";import"./ssrBoot-93503f06.js";import"./VDivider-b868c04b.js";import"./VCheckboxBtn-023236ba.js";import"./VDataTable-1136d52c.js";const Ce={class:"font-medium text-lg"},Te={key:0,class:"flex p-4"},De={id:"avatar"},Se=a("label",null,[T("Avatar "),a("span",{class:"text-xs"},"(Allowed PNG or JPEG. Max size of 2MB.)")],-1),Ee={class:"mt-2"},Ae={id:"name"},Le={id:"email"},Pe={class:"relative",id:"role_id"},Fe={class:"flex justify-between"},Ne={class:"flex flex-col",id:"delivery"},Be={class:"text-base",for:"status-switch"},Re=a("span",{class:"text-slate-300 text-xs"}," Allow to disable User without Deleting ",-1),Ie={id:"status"},ze={key:1},je={class:"demo-space-x"},qe=a("span",null,"Cancel",-1),Ke=Q({__name:"UserFormPopup",props:{preview:{type:Boolean},idToEdit:{}},emits:["update:isDialogVisible","getList"],setup(N,{emit:j}){const y=N,E=j,k=le("api"),v=A(!1),_=D({initial:!1,submitting:!1}),l=D({name:"",avatar:"",email:"",status:!1,role_id:""}),b=A({}),x=A([]),r=A({}),g=s=>{v.value=s},q=s=>{l.avatar=s,P("avatar")},B=()=>{v.value=!1;const s=setTimeout(()=>{Object.keys(l).forEach(o=>{l[o]=o==="status"?!1:""})},400);return()=>{clearTimeout(s)}},$=async()=>{_.initial=!0;try{const s=await k.admin.users.getCreateUser();b.value=await(s==null?void 0:s.data),r.value={}}catch(s){console.log(s)}_.initial=!1},K=async()=>{var s,o;_.initial=!0;try{const w=await k.admin.users.getEditUser(y.idToEdit);b.value=await(w==null?void 0:w.data);const d=await((s=b.value)==null?void 0:s.user);d&&(r.value={id:d.role.id,name:(o=d==null?void 0:d.role)==null?void 0:o.name},Object.keys(l).forEach(p=>{var C;p==="status"?l.status=d[p]==="active":p==="role_id"?l[p]=(C=d==null?void 0:d.role)==null?void 0:C.id:p!=="avatar"?l[p]=d[p]:d!=null&&d.avatar&&x.value.push({url:d.avatar})}))}catch(w){console.log(w)}_.initial=!1},L=async()=>{_.submitting=!0;try{let s={...l};if(typeof s.avatar=="string"){const{avatar:o,...w}=s;s=w}if(y.idToEdit){const o=await k.admin.users.editUser(y.idToEdit,s);console.log(o)}else{const o=await k.admin.users.createUser(s);console.log(o)}J.fire({icon:"success",padding:"10px",background:"#fff",html:`<span style="font-size:14px">User ${y.idToEdit?"Updated":"Added"} Successfully!</span>`}),B(),E("getList")}catch(s){console.log(s)}_.submitting=!1},M=()=>{l.status=!l.status,P("status")};return ee(()=>y.preview,s=>{g(s),s&&(y.idToEdit?K():$())}),ee(v,s=>{E("update:isDialogVisible",s),s||B()}),(s,o)=>{const w=oe,d=ne;return c(),S(ce,{modelValue:e(v),"onUpdate:modelValue":o[9]||(o[9]=p=>fe(v)?v.value=p:null),width:"500"},{default:m(()=>[n(w,{onClick:o[0]||(o[0]=p=>g(!1))}),n(re,null,{default:m(()=>[n(ye,{onSubmit:me(L,["prevent"]),class:"py-8 px-4 flex flex-col gap-4"},{default:m(()=>{var p,C;return[a("h3",Ce,h(s.idToEdit?"Edit":"Add")+" User ",1),e(_).initial?(c(),f("div",Te,[n(e(z),{icon:"tail-spin",class:"w-4 h-4 m-auto",color:"black"})])):(c(),f(pe,{key:1},[a("div",De,[Se,a("div",Ee,[n(e(xe),{"accepted-types":["png","jpg","jpeg","gif"],setFiles:q,"edit-form-files":e(x),single:""},null,8,["edit-form-files"])])]),a("div",Ae,[n(d,{onKeyup:o[1]||(o[1]=i=>("removeError"in s?s.removeError:e(P))("name")),type:"text",modelValue:e(l).name,"onUpdate:modelValue":o[2]||(o[2]=i=>e(l).name=i),placeholder:"Type here...",label:"Full Name",isRequired:!0},null,8,["modelValue"])]),a("div",Le,[n(d,{onKeyup:o[3]||(o[3]=i=>("removeError"in s?s.removeError:e(P))("email")),type:"email",modelValue:e(l).email,"onUpdate:modelValue":o[4]||(o[4]=i=>e(l).email=i),placeholder:"Type here...",label:"Email",isRequired:!0},null,8,["modelValue"])]),a("div",Pe,[(c(),S(e(we),{"onUpdate:modelValue":[o[5]||(o[5]=i=>("removeError"in s?s.removeError:e(P))("role_id")),o[6]||(o[6]=i=>e(l).role_id=i)],items:(p=e(b))==null?void 0:p.roles,modelValue:e(l).role_id,preSelectedItem:e(r),label:"Select Role",placeholder:"Select Role","item-title":"name","item-value":"id","disabled-key":"disabled",hasSearch:"",hasClosed:"",key:(C=e(r))==null?void 0:C.id,isRequired:!0},null,8,["items","modelValue","preSelectedItem"]))]),a("div",Fe,[a("div",Ne,[a("label",Be,h(e(l).status?"Active":"Inactive"),1),Re]),a("div",Ie,[n(be,{onClick:M,modelValue:e(l).status,"onUpdate:modelValue":o[7]||(o[7]=i=>e(l).status=i),id:"status-switch",color:"success",class:"cursor-pointer"},null,8,["modelValue"])])]),a("div",null,[n(F,{style:{float:"left"},type:"submit",block:"",color:"black",class:"text-white min-w-[100px] w-fit m-auto"},{default:m(()=>[e(_).submitting?(c(),S(e(z),{key:0,icon:"tail-spin",class:"w-4 h-4 m-auto",color:"white"})):(c(),f("span",ze,"Save"))]),_:1}),a("div",je,[n(F,{onClick:o[8]||(o[8]=i=>g(!1)),style:{float:"left","margin-left":"10px","background-color":"#efefef !important",color:"#999 !important"}},{default:m(()=>[qe]),_:1})])])],64))]}),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Me={key:0,class:"p-4 flex"},Ge={key:1,class:"flex flex-col gap-4"},Oe={class:"flex flex-wrap gap-4 justify-between"},Je={class:"d-flex align-center"},Qe={key:1},He={class:"d-flex flex-column"},We={class:"text-body-1 font-medium"},Ye={class:"text-sm text-disabled"},Ze={class:"flex items-center gap-2"},Xe=["onClick"],et=["onClick"],tt=["onClick"],st={key:0,class:"mt-4 flex"},at={class:"py-8 px-4"},it={class:"mb-2 flex"},ot={class:"text-center text-xl"},lt={key:0,class:"flex justify-center mx-auto my-2"},nt={class:"flex items-center"},rt={key:1},ct={class:"d-flex flex-column"},dt={class:"text-body-1 font-medium"},ut={class:"text-sm text-disabled"},mt={class:"mt-4 flex justify-center"},pt={key:1},ft=Q({__name:"UsersList",props:{isInRoles:{type:Boolean}},emits:["deleteUser"],setup(N,{emit:j}){const y=ve().getIsAdmin,E=N,k=le("api"),v=A([]),_=A({}),l=D({list:!1,deleting:!1,changingStatus:!1}),b=D({search:"",page:1,limit:E.isInRoles?5:10}),x=D({preview:!1,id:0}),r=D({preview:!1,item:null,status:""}),g=D({preview:!1,id:0}),q=[{title:"Name",key:"name",sortable:!1},{title:"Role",key:"role",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Actions",key:"actions",sortable:!1}],B=i=>{const u=i.toLowerCase();return u==="pending"?"warning":u==="active"?"success":u==="inactive"?"secondary":"primary"},$=async()=>{var i,u;l.list=!0;try{const V=await k.admin.users.getUsersList(b);v.value=await((i=V==null?void 0:V.data)==null?void 0:i.data),_.value=await((u=V==null?void 0:V.data)==null?void 0:u.meta)}catch(V){console.log(V)}l.list=!1},K=()=>{x.id=0,x.preview=!1},L=()=>{r.preview=!1,r.status="";const i=setTimeout(()=>{r.item=null},400);return()=>{clearTimeout(i)}},M=async()=>{l.changingStatus=!0;try{const i=r.status==="active"?"inactive":"active";await k.admin.users.changeStatus(r.item.id,i);const u=r.status==="active"?"De-Activated":"Activated";J.fire({icon:"success",padding:"10px",background:"#fff",html:`<span style="font-size:14px">User ${u} Successfully!</span>`}),L(),$()}catch(i){console.log(i)}l.changingStatus=!1},s=async()=>{l.deleting=!0;try{await k.admin.users.deleteUser(x.id),J.fire({icon:"success",padding:"10px",background:"#fff",html:'<span style="font-size:14px">User Deleted Successfully!</span>'}),K(),$()}catch(i){console.log(i)}l.deleting=!1},o=i=>{x.id=i,x.preview=!0},w=()=>{g.id=0,g.preview=!0},d=i=>{g.id=i,g.preview=!0},p=i=>{r.item=i,r.preview=!0,r.status=i.status},C=_e(()=>{b.page=1,$()},600);return $(),(i,u)=>{const V=ne,de=Ke,ue=oe,R=ge("can");return c(),f("section",null,[e(l).list&&!e(v).length?(c(),f("div",Me,[n(e(z),{icon:"tail-spin",class:"w-6 h-6 m-auto",color:"black"})])):(c(),f("div",Ge,[a("div",Oe,[a("div",null,[n(V,{type:"text",modelValue:e(b).search,"onUpdate:modelValue":u[0]||(u[0]=t=>e(b).search=t),label:"Search",placeholder:"Type here...",class:"w-[200px] sm:w-[250px]",onKeyup:e(C)},null,8,["modelValue","onKeyup"])]),I((c(),S(F,{primary:"",color:"black",class:"text-white mt-auto",onClick:w},{default:m(()=>[n(G,{size:"20",icon:"tabler-plus",class:"mr-1"}),T(" Add New User ")]),_:1})),[[R,"create-admins"]])]),a("div",null,[n(e(Ue),{items:e(v),itemsLength:e(v).length,headers:q,class:O(["text-no-wrap",{"opacity-70":e(l).list&&e(v).length}])},{"item.name":m(({item:t})=>[a("div",Je,[n(ae,{size:"38",variant:t.avatar?void 0:"tonal",class:"me-3"},{default:m(()=>[t!=null&&t.avatar?(c(),S(ie,{key:0,src:t.avatar},null,8,["src"])):(c(),f("span",Qe,h(("avatarText"in i?i.avatarText:e(X))(t==null?void 0:t.name)),1))]),_:2},1032,["variant"]),a("div",He,[a("h6",We,h(t==null?void 0:t.name),1),a("span",Ye,h((t==null?void 0:t.email)||"N/A"),1)])])]),"item.role":m(({item:t})=>{var U;return[a("div",null,h(((U=t==null?void 0:t.role)==null?void 0:U.name)||"N/A"),1)]}),"item.status":m(({item:t})=>[n($e,{label:"",size:"small",class:O(["text-capitalize",{"bg-[#eaebed] text-[#8e929d]":t.status==="inactive"}]),color:t.status!=="inactive"?B(t.status):void 0},{default:m(()=>[T(h(t==null?void 0:t.status),1)]),_:2},1032,["class","color"])]),"item.actions":m(({item:t})=>[a("div",Ze,[I((c(),f("button",{class:"flex items-center gap-1",onClick:U=>d(t.id)},[n(G,{icon:"tabler-edit"}),T(" Edit ")],8,Xe)),[[R,"edit-admins"]]),I((c(),f("button",{class:"flex items-center gap-1",onClick:U=>p(t)},[n(e(se),{icon:t.status==="active"?"ToggleLeft":"ToggleRight"},null,8,["icon"]),a("span",null,h(t.status==="active"?"De-Activate":"Activate"),1)],8,et)),[[R,"activate-admins"]]),I((c(),f("button",{class:"flex items-center gap-1",onClick:U=>o(t.id)},[n(G,{icon:"tabler-trash",class:"text-danger"}),T(" Delete ")],8,tt)),[[R,"delete-admins"]])])]),bottom:m(()=>[]),_:1},8,["items","itemsLength","class"]),e(_)?(c(),f("div",st,[n(ke,{onPageChanged:u[1]||(u[1]=t=>{e(b).page=t,$()}),meta:e(_),class:"w-full sm:w-auto sm:mr-auto"},null,8,["meta"])])):te("",!0)])])),n(e(Ve),{isAdmin:!0,preview:e(x).preview,itemName:"User",deleteFn:s,isDeleting:e(l).deleting,isDialogVisible:e(x).preview,"onUpdate:isDialogVisible":u[2]||(u[2]=t=>e(x).preview=t)},null,8,["preview","isDeleting","isDialogVisible"]),n(de,{preview:e(g).preview,idToEdit:e(g).id,isDialogVisible:e(g).preview,"onUpdate:isDialogVisible":u[3]||(u[3]=t=>e(g).preview=t),onGetList:$},null,8,["preview","idToEdit","isDialogVisible"]),n(ce,{modelValue:e(r).preview,"onUpdate:modelValue":u[4]||(u[4]=t=>e(r).preview=t),width:"500"},{default:m(()=>[n(ue,{onClick:L}),n(re,null,{default:m(()=>{var t,U,H;return[a("div",at,[a("div",it,[n(e(se),{icon:"Info",class:"text-danger m-auto w-16 h-16"})]),a("div",ot," Are you sure you want to "+h(e(r).status==="active"?"De-Activate":"Activate")+" this user ? ",1),e(r).item?(c(),f("div",lt,[a("div",nt,[n(ae,{size:"38",variant:(t=e(r).item)!=null&&t.avatar?void 0:"tonal",class:"me-3"},{default:m(()=>{var W,Y,Z;return[(W=e(r).item)!=null&&W.avatar?(c(),S(ie,{key:0,src:(Y=e(r).item)==null?void 0:Y.avatar},null,8,["src"])):(c(),f("span",rt,h(("avatarText"in i?i.avatarText:e(X))((Z=e(r).item)==null?void 0:Z.name)),1))]}),_:1},8,["variant"]),a("div",ct,[a("h6",dt,h((U=e(r).item)==null?void 0:U.name),1),a("span",ut,h(((H=e(r).item)==null?void 0:H.email)||"N/A"),1)])])])):te("",!0),a("div",mt,[n(F,{color:"#f1f1f2",onClick:L},{default:m(()=>[T("No!")]),_:1}),T("     "),n(F,{class:O(["flex",{"text-white":e(y)}]),color:e(y)?"black":void 0,onClick:M},{default:m(()=>[e(l).changingStatus?(c(),S(e(z),{key:0,icon:"tail-spin",color:"white",class:"w-4 h-4 m-auto"})):(c(),f("span",pt,"Yes?"))]),_:1},8,["color","class"])])])]}),_:1})]),_:1},8,["modelValue"])])}}}),vt={class:"flex flex-col gap-4"},_t=a("div",{class:"flex flex-col gap-4"},[a("h1",{class:"text-xl font-medium text-[#2F2B3DC7]"},"Users List"),a("p",{class:"max-w-[600px] text-[#2F2B3DC7]"}," A role provided access to predefined modules and features so that depending on assigned role an administrator can have access to what he need ")],-1),gt={class:"mt-4"},Zt=Q({__name:"index",setup(N){return he("Users"),(j,y)=>{const E=ft;return c(),f("section",vt,[_t,a("div",gt,[n(E)])])}}});export{Zt as default};
