import{G as $,_ as q}from"./ReceiptTemplate.vue_vue_type_script_setup_true_lang-4ab734f1.js";import{d as z,J as K,r as G,o as M,h as N,k as Q}from"./index-ab2bc521.js";const Z=z({__name:"field",props:{receipt:{type:Object,default:{}},type:{type:String,default:""},order:{type:Object,default:{}},transaction:{type:Object,default:{}},posSetting:{type:Object,default:{}}},setup(l){var d;const a=l,H=K("api"),i=G([]),c=G([]),O=async()=>{var n;try{const e=await H.settings.receipts.getReceiptTypeFields(a.type);c.value=(n=e==null?void 0:e.data)==null?void 0:n.fields,i.value.length&&U()}catch(e){console.log(e)}},U=()=>{c.value.forEach((n,e)=>{if(n.type!=="repeatable"){const t=n.id;i.value.findIndex(r=>r.id===t)!==-1&&(c.value[e].inactive=!0)}})},A=n=>{const e={};for(const t in n)n[t]==="true"?e[t]=!0:n[t]==="false"?e[t]=!1:e[t]=n[t];return e},J=n=>{i.value=n.map(e=>{var m,u,g,x,h,v,S,D,F,T,w,P,I,k,C,R,L,B,E,f;let t={...e};e.name=="Items & Details"&&(a.type=="kitchen-bar"&&((m=e==null?void 0:e.receipt_data)==null||delete m.options[0].selected_options.Discounts,(u=e==null?void 0:e.receipt_data)==null||delete u.options[0].selected_options.Comment,t.options=t.options.otherData.filter(s=>s!=="Discounts"&&s!=="Comment")),a.type=="terminal"&&((g=e==null?void 0:e.receipt_data)==null||delete g.options[0].selected_options.Discounts,(x=e==null?void 0:e.receipt_data)==null||delete x.options[0].selected_options.Comment,(h=e==null?void 0:e.receipt_data)==null||delete h.options[0].selected_options["Highlight modifiers"],t.options=t.options.otherData.filter(s=>s!=="Discounts"&&s!=="Comment"&&s!=="Highlight modifiers")));const o=(v=e==null?void 0:e.receipt_data)==null?void 0:v.options[0],r=o==null?void 0:o.display_when_paying_cash,y=o==null?void 0:o.display_when_paying_other_types;if(e.type!=="repeatable"){const s=c.value.findIndex(p=>p.id===e.id);s!==-1&&(c.value[s].inactive=!0)}if(((S=e==null?void 0:e.options)==null?void 0:S.style)||((D=e==null?void 0:e.options)==null?void 0:D.direction)){const s=o==null?void 0:o.selected_styles;t={...t,selected_styles:s||[]}}if($.includes(e.name)){const s=A(o==null?void 0:o.selected_options);if(t={...t,selected_options:s||{}},s["split taxes"]&&(F=t==null?void 0:t.options)!=null&&F.orderPayments){const p=(w=(T=t==null?void 0:t.options)==null?void 0:T.orderPayments)==null?void 0:w.indexOf("Tax");if(p!==-1)(I=(P=t==null?void 0:t.options)==null?void 0:P.orderPayments)==null||I.splice(p,1,"Tax 1","Tax 2");else{const _=(C=(k=t==null?void 0:t.options)==null?void 0:k.orderPayments)==null?void 0:C.indexOf("Tax 1"),V=(L=(R=t==null?void 0:t.options)==null?void 0:R.orderPayments)==null?void 0:L.indexOf("Tax 2");_!==-1&&V===_+1&&((E=(B=t==null?void 0:t.options)==null?void 0:B.orderPayments)==null||E.splice(_,2,"Tax"))}}}return r&&(t={...t,display_when_paying_cash:r}),y&&(t={...t,display_when_paying_other_types:y}),e.name==="Logo"&&(t={...t,options:{Logo:{image:{dataURL:(f=a==null?void 0:a.receipt)==null?void 0:f.logo},is_editable:!1}}}),t})};return O(),J((d=a.receipt)==null?void 0:d.fields),(n,e)=>{const t=q;return M(),N(t,{order:a.order,transaction:a.transaction,posSetting:l.posSetting,fields:Q(i),class:"md:w-[265px] mx-auto lg:w-auto"},null,8,["order","transaction","posSetting","fields"])}}});export{Z as _};
